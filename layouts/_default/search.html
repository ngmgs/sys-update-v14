{{- define "main" -}}
<header class="page-header">
    <h1>{{ .Title }}</h1>
</header>

<div id="searchbox">
    <input id="searchInput" autofocus placeholder="{{ .Params.placeholder | default "検索ワードを入力..." }}" aria-label="search" type="search">
    <ul id="searchResults" aria-label="search results"></ul>
</div>

<script>
window.addEventListener('DOMContentLoaded', () => {
    const searchInput = document.getElementById('searchInput');
    const searchResults = document.getElementById('searchResults');

    // PaperModの検索結果表示機能を上書き
    window.renderResults = (results) => {
        if (results.length === 0) {
            searchResults.innerHTML = '';
            return;
        }

        searchResults.innerHTML = results.map(result => {
            const item = result.item;
            // トップページ(list.html)の構造を再現
            return `
                <article class="post-entry">
                    ${item.image ? `
                    <figure class="entry-cover">
                        <img src="${item.image}" alt="${item.title}" loading="lazy">
                    </figure>` : ''}
                    <header class="entry-header">
                        <h2>${item.title}</h2>
                    </header>
                    <div class="entry-content">
                        <p>${item.summary}</p>
                    </div>
                    <a class="entry-link" aria-label="post link to ${item.title}" href="${item.permalink}"></a>
                </article>
            `;
        }).join('');
    };
});
</script>

<style>
/* トップページのリスト形式に寄せるためのスタイル */
#searchResults {
    list-style: none;
    padding: 0;
}
.post-entry {
    position: relative;
    margin-bottom: 20px;
    padding: 20px;
    background: var(--entry);
    border-radius: var(--radius);
    transition: transform 0.1s;
    border: 1px solid var(--border);
}
.post-entry:hover {
    transform: translateY(-2px);
}
.entry-cover img {
    width: 100%;
    height: auto;
    border-radius: var(--radius);
    margin-bottom: 15px;
    object-fit: cover;
    max-height: 300px; /* 画像が大きすぎないように制限 */
}
.entry-header h2 {
    font-size: 1.5rem;
    margin-bottom: 10px;
}
.entry-content {
    font-size: 0.9rem;
    color: var(--secondary);
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
}
</style>
{{- end -}}